
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¸å®‰ Alpha ç©ºæŠ•æ—¥å† - å®æ—¶ç›‘æ§å¸å®‰Alphaé¡¹ç›®ç©ºæŠ•</title>
    <meta name="description" content="å¸å®‰ Alpha ç©ºæŠ•æ—¥å†ä¸ºæ‚¨æä¾›æœ€æ–°çš„å¸å®‰Alphaé¡¹ç›®ç©ºæŠ•ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä»Šæ—¥ç©ºæŠ•å’Œç©ºæŠ•é¢„å‘Šï¼Œå¸®åŠ©æ‚¨ä¸é”™è¿‡ä»»ä½•ä¸€æ¬¡å¸å®‰Alphaé¡¹ç›®çš„ç©ºæŠ•æœºä¼šã€‚">
    <meta name="keywords" content="å¸å®‰,Binance,Alpha,ç©ºæŠ•,å¸å®‰ç©ºæŠ•,ç©ºæŠ•æ—¥å†,Alphaç©ºæŠ•,åŠ å¯†è´§å¸,æ•°å­—è´§å¸">
    <meta name="author" content="alpha123.uk">
    <meta property="og:title" content="å¸å®‰ Alpha ç©ºæŠ•æ—¥å†">
    <meta property="og:description" content="å®æ—¶è¿½è¸ªå¸å®‰ Alpha é¡¹ç›®ç©ºæŠ•">
    <meta property="og:url" content="https://alpha123.uk/zh/">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="å¸å®‰ Alpha ç©ºæŠ•æ—¥å†">
    <meta property="og:locale" content="zh_CN">
    <!-- Open Graph / Facebook -->
    <meta property="og:image" content="https://alpha123.uk/AirdropsCalendar/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="å¸å®‰ Alpha ç©ºæŠ•æ—¥å† - å®æ—¶è¿½è¸ªç©ºæŠ•">
    
    <!-- Twitter Card - è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ˜¾ç¤ºæ–¹å¼ -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="å¸å®‰ Alpha ç©ºæŠ•æ—¥å†">
    <meta name="twitter:description" content="å®æ—¶è¿½è¸ªå¸å®‰ Alpha é¡¹ç›®ç©ºæŠ•">
    <meta name="twitter:image" content="https://alpha123.uk/AirdropsCalendar/og-image-144.png">
    <meta name="twitter:image:alt" content="å¸å®‰ Alpha ç©ºæŠ•æ—¥å† - å®æ—¶è¿½è¸ªç©ºæŠ•">
    
    <!-- å¤‡ç”¨å°å°ºå¯¸å›¾ç‰‡ä¸å†é€šè¿‡ twitter:image:src æŒ‡å®šï¼Œé¿å…ä¸ summary_large_image å†²çª -->
    <meta name="twitter:site" content="@alpha123uk">
    <meta name="twitter:creator" content="@alpha123uk">
    <link rel="icon" type="image/png" href="/AirdropsCalendar/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/AirdropsCalendar/favicon.svg" />
    <link rel="shortcut icon" href="/AirdropsCalendar/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/AirdropsCalendar/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="å¸å®‰Alphaç©ºæŠ•" />
    <link rel="manifest" href="/AirdropsCalendar/site.webmanifest" />
    <link rel="canonical" href="https://alpha123.uk/zh/" />
    <link rel="alternate" hreflang="x-default" href="https://alpha123.uk/" />
    <link rel="alternate" hreflang="en" href="https://alpha123.uk/" />
    <link rel="alternate" hreflang="zh-CN" href="https://alpha123.uk/zh/" />
    <link rel="alternate" hreflang="ja-JP" href="https://alpha123.uk/ja/" />
    <link rel="alternate" hreflang="ko-KR" href="https://alpha123.uk/ko/" />
    <link rel="alternate" hreflang="vi-VN" href="https://alpha123.uk/vi/" />
    <link rel="stylesheet" href="/css/bootstrap-icons.css">
    <link rel="stylesheet" href="/css/airdrop.css?v=1.0.42">
    <script src="/js/language.js?v=1.0.3"></script>
    <script src="/js/tge-info.js?v=1.0.20"></script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "å¸å®‰ Alpha ç©ºæŠ•æ—¥å†",
      "url": "https://alpha123.uk/zh/",
      "publisher": {
        "@type": "Organization",
        "name": "Alpha123",
        "url": "https://alpha123.uk/",
        "sameAs": [
          "https://twitter.com/alpha123cc",
          "https://twitter.com/alpha123uk"
        ]
      }
    }
    </script>
</head>
<body>
    <header>
        <div class="container">
            <a href="/zh" class="logo">
                å¸å®‰ <span>Alpha</span> ç©ºæŠ•æ—¥å†
            </a>
            <button id="refreshButton" class="theme-toggle">
                <i class="bi bi-arrow-clockwise"></i>
            </button>
            <div class="header-links">
                <a href="/zh" class="nav-link active">ä»Šæ—¥ç©ºæŠ•</a>
                <a href="/zh/history.html" class="nav-link">å†å²ç©ºæŠ•</a>
                <a href="/calendar/" class="nav-link">æ”¶ç›Šæ—¥å†</a>
            </div>
        </div>
    </header>
    <main class="main">
        <div class="container">
            <h2 class="section-title">
                <i class="bi bi-gift-fill"></i> ä»Šæ—¥ç©ºæŠ•
            </h2>
            <div class="airdrops-table-wrapper">
                <table class="airdrops-table" id="today-airdrops">
                    <thead>
                        <tr>
                            <th>é¡¹ç›®</th>
                            <th>ç§¯åˆ†</th>
                            <th>æ•°é‡</th>
                            <th>æ—¶é—´</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="4" class="loading">
                                <div class="spinner"></div>
                                <p>åŠ è½½ä¸­...</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <h2 class="section-title"><i class="bi bi-calendar-event"></i> ç©ºæŠ•é¢„å‘Š</h2>
            <div class="airdrops-table-wrapper">
                <table class="airdrops-table" id="upcoming-airdrops">
                    <thead>
                        <tr>
                            <th>é¡¹ç›®</th>
                            <th>ç§¯åˆ†</th>
                            <th>æ•°é‡</th>
                            <th>æ—¶é—´</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="4" class="loading">
                                <div class="spinner"></div>
                                <p>åŠ è½½ä¸­...</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <h2 class="section-title"><i class="bi bi-tools"></i> æ¨èå·¥å…·</h2>
            <div class="airdrops-table-wrapper">
                <table class="airdrops-table" id="promo-tools">
                    <thead>
                        <tr>
                            <th>å·¥å…·</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="loading">
                                <div class="spinner"></div>
                                <p>åŠ è½½ä¸­...</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>    
    <!-- æ¨ç‰¹æé†’æ¨¡æ€æ¡† -->
    <div id="twitterReminderModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="bi bi-bell-fill" style="color: #F0B90B;"></i> ç©ºæŠ•æé†’</h3>
                <button class="modal-close" onclick="closeTwitterModal()" style="-webkit-tap-highlight-color: transparent; touch-action: manipulation;">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="reminder-text">
                    <p>Alpha123ä¸­æ–‡æ¨ç‰¹ç©ºæŠ•å‰20åˆ†é’Ÿæ¨é€ï¼Œå…³æ³¨åå†ç‚¹ğ•å°é“ƒé“›å³å¯æ”¶åˆ°é€šçŸ¥ã€‚</p>
                </div>
                
                <div class="modal-actions">
                    <a href="twitter://user?screen_name=alpha123cc" target="_blank" class="twitter-btn" onclick="handleTwitterLink(event)">
                        ğ• é€šçŸ¥
                    </a>
                    <a href="https://t.me/alpha123cn" target="_blank" rel="noopener noreferrer" class="twitter-btn telegram-btn">
                        <i class="bi bi-telegram" style="margin-right: 6px;"></i>é€šçŸ¥
                    </a>
                    <a href="/manual/zh/debot-tutorial.html" target="_blank" rel="noopener noreferrer" class="twitter-btn dingtalk-btn">
                        é’‰é’‰é€šçŸ¥
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- TGEä¿¡æ¯å¼¹çª— -->
    <div id="tgeInfoModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="bi bi-bar-chart-fill" style="color: #F0B90B;"></i> <span id="tgeModalTitle">TGEç»Ÿè®¡</span></h3>
                <button id="tgeRefreshBtn" class="modal-close" onclick="refreshTgeInfoModal()" title="åˆ·æ–°" style="margin-right: 6px; background-color: var(--card-bg); color: #F0B90B; width: 40px; height: 40px; padding: 0; -webkit-tap-highlight-color: transparent; touch-action: manipulation;">
                    <i class="bi bi-arrow-clockwise" style="color: #F0B90B; display: inline-block; font-size: 18px;"></i>
                </button>
                <button class="modal-close" onclick="closeTgeInfoModal()" style="width: 40px; height: 40px; padding: 0; -webkit-tap-highlight-color: transparent; touch-action: manipulation;">
                    <i class="bi bi-x-lg" style="font-size: 18px;"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="tge-info-content">
                    <div class="tge-info-row">
                        <span class="tge-label">ç›®æ ‡</span>
                        <span class="tge-value"><span id="tgeTargetBnb"></span> BNB</span>
                    </div>
                    
                    <div class="tge-info-row">
                        <span class="tge-label">å·²å‹Ÿ</span>
                        <span class="tge-value"><span id="tgeActualBnb"></span> BNB</span>
                    </div>
                    
                    <div class="tge-info-row">
                        <span class="tge-label">è¶…å‹Ÿ</span>
                        <span class="tge-value"><span id="tgeOversubscription"></span>x</span>
                    </div>
                    
                    <div class="tge-info-row">
                        <span class="tge-label">æŠ•å…¥</span>
                        <span class="tge-value">
                            <input type="number" id="bnbInput" value="3.0" min="0" step="0.1" 
                                   onchange="updateCostCalculation()" oninput="updateCostCalculation()" onblur="formatBnbInput(this)"> <span>BNB</span>
                        </span>
                    </div>
                    
                    <div class="tge-info-row">
                        <span class="tge-label">å¯å¾—</span>
                        <span class="tge-value"><span id="tgeTokenAmount"></span> <span id="tgeTokenSymbol"></span></span>
                    </div>
                    
                    <div class="tge-info-row">
                        <span class="tge-label">æˆæœ¬</span>
                        <span class="tge-value"><span id="tgeCost"></span> BNB</span>
                    </div>
                    
                    <div class="tge-info-row">
                        <span class="tge-label">ä»·å€¼</span>
                        <span class="tge-value tge-estimate"><div id="tgeEstimateUsd" class="value-text dex-price-value">-</div></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <a href="https://alpha123.uk" class="footer-link"><i class="bi bi-globe2"></i> alpha123.uk</a>
                </div>
                <div class="footer-right">
                    <div class="footer-links">
                        <div class="language-dropdown">
                            <a href="#" class="footer-link language-selector"><i class="bi bi-translate"></i> Language <i class="bi bi-caret-up-fill"></i></a>
                            <div class="language-menu">
                                <a href="/index.html" class="language-option" data-lang="en">English</a>
                                <a href="/zh/index.html" class="language-option" data-lang="zh">ä¸­æ–‡</a>
                                <a href="/ja/index.html" class="language-option" data-lang="ja">æ—¥æœ¬èª</a>
                                <a href="/ko/index.html" class="language-option" data-lang="ko">í•œêµ­ì–´</a>
                                <a href="/vi/index.html" class="language-option" data-lang="vi">Tiáº¿ng Viá»‡t</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <script>
        // æ·»åŠ æ—¶åŒºè¾…åŠ©å·¥å…·å¯¹è±¡
        const TimeZoneHelper = {
            // å¸¸é‡ï¼šåŒ—äº¬æ—¶åŒºåç§»ï¼ˆUTC+8ï¼‰
            BEIJING_OFFSET: 8,
            
            // è·å–å½“å‰ç”¨æˆ·çš„æ—¶åŒºåç§»ï¼ˆå°æ—¶ï¼‰
            getUserTimezoneOffset: function() {
                return -new Date().getTimezoneOffset() / 60;
            },
            
            // æ£€æŸ¥æ—¥æœŸæ˜¯å¦æ˜¯ä»Šå¤©
            isToday: function(dateObj) {
                const today = new Date();
                return dateObj.getDate() === today.getDate() &&
                       dateObj.getMonth() === today.getMonth() &&
                       dateObj.getFullYear() === today.getFullYear();
            },
            
            // æ£€æŸ¥æ—¥æœŸæ˜¯å¦æ˜¯æ˜å¤©
            isTomorrow: function(dateObj) {
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                return dateObj.getDate() === tomorrow.getDate() &&
                       dateObj.getMonth() === tomorrow.getMonth() &&
                       dateObj.getFullYear() === tomorrow.getFullYear();
            },
            
            // æ£€æŸ¥æ—¥æœŸæ˜¯å¦æ˜¯åå¤©
            isDayAfterTomorrow: function(dateObj) {
                const dayAfterTomorrow = new Date();
                dayAfterTomorrow.setDate(dayAfterTomorrow.getDate() + 2);
                return dateObj.getDate() === dayAfterTomorrow.getDate() &&
                       dateObj.getMonth() === dayAfterTomorrow.getMonth() &&
                       dateObj.getFullYear() === dayAfterTomorrow.getFullYear();
            },
            
            // æ ¼å¼åŒ–æ—¶é—´ä¸ºæœ¬åœ°æ—¶é—´å­—ç¬¦ä¸²
            formatTime: function(dateObj) {
                return dateObj.toLocaleTimeString('zh-CN', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
            },
            
            // å°†åŒ—äº¬æ—¶é—´è½¬æ¢ä¸ºæœ¬åœ°æ—¶é—´
            convertBeijingToLocal: function(dateStr, timeStr, isPhase2 = false) {
                try {
                    if (!dateStr || !timeStr) {
                        return { success: false };
                    }
                    
                    // è§£æåŒ—äº¬æ—¶é—´
                    const beijingDateTime = new Date(`${dateStr}T${timeStr}:00+08:00`);
                    
                    if (isNaN(beijingDateTime.getTime())) {
                        return { success: false };
                    }
                    
                    // å¦‚æœæ˜¯äºŒæ®µç©ºæŠ•ï¼Œæ ¹æ®ä¸šåŠ¡è§„åˆ™åŠ 18å°æ—¶
                    let finalDateTime = new Date(beijingDateTime);
                    if (isPhase2) {
                        finalDateTime = new Date(beijingDateTime.getTime() + 18 * 60 * 60 * 1000);
                    }
                    
                    // æå–æœ¬åœ°æ—¶é—´çš„æ—¥æœŸå’Œæ—¶é—´éƒ¨åˆ†
                    const localDate = finalDateTime.toISOString().split('T')[0];
                    const localTime = finalDateTime.toLocaleTimeString('zh-CN', {
                        hour: '2-digit',
                        minute: '2-digit',
                        hour12: false
                    });
                    
                    return {
                        success: true,
                        date: localDate,
                        time: localTime,
                        dateTime: finalDateTime,
                        beijing_date: dateStr,
                        beijing_time: timeStr
                    };
                } catch (e) {
                    console.error('æ—¶åŒºè½¬æ¢é”™è¯¯:', e);
                    return { success: false };
                }
            }
        };

        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });
        function initializeApp() {
            loadAirdropData(true);
            checkForVersionUpdate(); // æ£€æŸ¥ç‰ˆæœ¬æ›´æ–°
            loadPromoData(); // åŠ è½½æ¨èå·¥å…·æ•°æ®
            const refreshInterval = 10 * 60 * 1000;
            if (window.autoRefreshTimer) {
                clearInterval(window.autoRefreshTimer);
            }
            window.autoRefreshTimer = setInterval(function() {
                refreshData(true);
            }, refreshInterval);
            resetCountdown(refreshInterval / 1000);
            const refreshButton = document.getElementById('refreshButton');
            refreshButton.addEventListener('click', function() {
                refreshData(true);
                const icon = this.querySelector('i');
                icon.classList.add('rotating');
                setTimeout(() => {
                    icon.classList.remove('rotating');
                }, 1000);
            });
        }
        
        // ç‰ˆæœ¬æ£€æŸ¥å’Œè‡ªåŠ¨åˆ·æ–°åŠŸèƒ½
        function checkVersionAndRefresh(currentVersion) {
            if (!currentVersion) return;
            
            // ä»localStorageè·å–å­˜å‚¨çš„ç‰ˆæœ¬å·
            const storedVersion = localStorage.getItem('promo_data_version');
            
            if (storedVersion && storedVersion !== currentVersion) {
                console.log('æ£€æµ‹åˆ°ç‰ˆæœ¬æ›´æ–°ï¼Œå‡†å¤‡åˆ·æ–°é¡µé¢...', {
                    stored: storedVersion,
                    current: currentVersion
                });
                
                // æ›´æ–°å­˜å‚¨çš„ç‰ˆæœ¬å·
                localStorage.setItem('promo_data_version', currentVersion);
                
                // å»¶è¿Ÿ500msååˆ·æ–°é¡µé¢ï¼Œé¿å…é¢‘ç¹åˆ·æ–°
                setTimeout(() => {
                    window.location.reload();
                }, 500);
            } else {
                // é¦–æ¬¡è®¿é—®æˆ–ç‰ˆæœ¬æ— å˜åŒ–ï¼Œæ›´æ–°å­˜å‚¨çš„ç‰ˆæœ¬å·
                localStorage.setItem('promo_data_version', currentVersion);
            }
        }
        
        // è½¬æ¢chain_idä¸ºé“¾åç§°
        function getChainName(chainId) {
            const chainMap = {
                '1': 'eth',
                '56': 'bsc',
                '137': 'polygon',
                '42161': 'arbitrum',
                '10': 'optimism',
                '8453': 'base',
                '43114': 'avalanche',
                '250': 'fantom',
                '25': 'cronos',
                '1101': 'polygon_zkevm',
                '324': 'zksync',
                '59144': 'linea',
                '7777777': 'zora',
                '534352': 'scroll',
                '81457': 'blast',
                '501': 'solana',
                '784': 'sui',
                '196': 'xlayer',
                'sui': 'sui'
            };
            
            return chainMap[chainId] || 'bsc'; // é»˜è®¤è¿”å›bsc
        }

        // å°†åå…­è¿›åˆ¶é¢œè‰²è½¬æ¢ä¸ºå¸¦é€æ˜åº¦çš„rgbaå­—ç¬¦ä¸²
        function hexToRgba(hex, alpha) {
            try {
                let h = hex.replace('#', '').trim();
                if (h.length === 3) {
                    h = h.split('').map(c => c + c).join('');
                }
                const bigint = parseInt(h, 16);
                const r = (bigint >> 16) & 255;
                const g = (bigint >> 8) & 255;
                const b = bigint & 255;
                const a = (typeof alpha === 'number') ? alpha : 1;
                return `rgba(${r},${g},${b},${a})`;
            } catch (e) {
                return 'rgba(240,185,11,0.1)';
            }
        }

        // åˆ¤æ–­æ˜¯å¦ä½¿ç”¨ Debotï¼ˆä»…å…è®¸çš„ EVM é“¾ï¼‰
        function shouldUseDebot(chainId) {
            const normalized = String(chainId).trim().toLowerCase();
            // ä»…ä»¥ä¸‹7æ¡é“¾ä½¿ç”¨ Debotï¼šETH, BSC, Base, Solana, X Layer, Polygon, Arbitrum
            const debotAllowed = new Set(['1','56','8453','501','196','137','42161']);
            return debotAllowed.has(normalized);
        }
        
        // æ£€æŸ¥ç‰ˆæœ¬æ›´æ–°
        function checkForVersionUpdate() {
            fetch('/version.json')
                .then(response => response.json())
                .then(versionData => {
                    if (versionData && versionData.version) {
                        checkVersionAndRefresh(versionData.version);
                    }
                })
                .catch(error => {
                    console.error('ç‰ˆæœ¬æ£€æŸ¥é”™è¯¯:', error);
                });
        }
        
        // å…¨å±€å˜é‡å­˜å‚¨æ¨å¹¿æ•°æ®
        let globalPromoData = null;
        
        // åŠ è½½æ¨èå·¥å…·æ•°æ®
        function loadPromoData() {
            fetch('/zh/promo-data.json')
                .then(response => response.json())
                .then(data => {
                    if (data && data.promo_items && Array.isArray(data.promo_items)) {
                        globalPromoData = data.promo_items; // å­˜å‚¨å…¨å±€æ•°æ®
                        renderPromoTools(data.promo_items);
                        
                        if (Array.isArray(window.todayAirdrops) && Array.isArray(window.upcomingAirdrops)) {
                            const hasAnyAirdrops = (window.todayAirdrops.length > 0) || (window.upcomingAirdrops.length > 0);
                            if (!hasAnyAirdrops) {
                                renderAirdropTable(window.todayAirdrops, 'today-airdrops');
                                renderAirdropTable(window.upcomingAirdrops, 'upcoming-airdrops');
                            }
                        }
                    } else {
                        displayPromoNoDataMessage();
                    }
                })
                .catch(error => {
                    console.error('åŠ è½½æ¨èå·¥å…·æ•°æ®å¤±è´¥:', error);
                    displayPromoNoDataMessage();
                });
        }
        
        // æ¸²æŸ“æ¨èå·¥å…·è¡¨æ ¼
        function renderPromoTools(promoItems) {
            const tableBody = document.querySelector('#promo-tools tbody');
            tableBody.innerHTML = '';
            
            // è¿‡æ»¤æ‰ fallback ç±»å‹çš„é¡¹ç›®ï¼ˆç”¨äºæš‚æ— æ•°æ®æ—¶æ˜¾ç¤ºï¼‰
            const displayItems = promoItems.filter(item => item.category !== 'fallback');
            
            if (displayItems.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td style="text-align: center; padding: 30px;">
                            <div style="color: var(--muted); margin-bottom: 12px;">æš‚æ— æ¨èå·¥å…·</div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            // æŒ‰orderå­—æ®µæ’åº
            displayItems.sort((a, b) => (a.order || 999) - (b.order || 999));
            
            displayItems.forEach(item => {
                const row = document.createElement('tr');
                const toolCell = document.createElement('td');
                
                // å·¥å…·åç§°ä½¿ç”¨é“¾æ¥ï¼ˆå¦‚æœå¯ç”¨ï¼‰
                let toolNameHtml = item.name;
                if (item.url && item.status === 'active') {
                    toolNameHtml = `<a class="token-link" href="${item.url}" target="_blank" rel="noopener">${item.name}<i class="bi ${item.icon} contract-icon"></i></a>`;
                } else {
                    toolNameHtml = `${item.name}<i class="bi ${item.icon} contract-icon"></i>`;
                }
                
                toolCell.innerHTML = `
                    <div class="token-name">
                        <div>
                            <div class="token-symbol">
                                ${toolNameHtml}
                            </div>
                            <div class="token-fullname">${item.description}</div>
                        </div>
                    </div>
                `;
                
                row.appendChild(toolCell);
                tableBody.appendChild(row);
            });
        }
        
        
        // å·²å»é™¤æ—¶é—´æˆ³å‚æ•°ï¼Œäº¤ç”±ä¸Šæ¸¸ç¼“å­˜æ§åˆ¶åˆ·æ–°èŠ‚å¥
        
        function refreshData(clearCache) {
            // æ¯æ¬¡åˆ·æ–°æ—¶ä¹Ÿæ£€æŸ¥ç‰ˆæœ¬æ›´æ–°
            checkForVersionUpdate();
            
            document.querySelector('#today-airdrops tbody').innerHTML = `
                <tr>
                    <td colspan="4" class="loading">
                        <div class="spinner"></div>
                        <p>åŠ è½½ä¸­...</p>
                    </td>
                </tr>
            `;
            document.querySelector('#upcoming-airdrops tbody').innerHTML = `
                <tr>
                    <td colspan="4" class="loading">
                        <div class="spinner"></div>
                        <p>åŠ è½½ä¸­...</p>
                    </td>
                </tr>
            `;
            showRefreshingIndicator();
            loadAirdropData(clearCache);
            const refreshInterval = 10 * 60 * 1000;
            resetCountdown(refreshInterval / 1000);
        }
        function showRefreshingIndicator() {
            // æ˜¾ç¤ºåˆ·æ–°ä¸­çš„çŠ¶æ€
            const refreshBtn = document.getElementById('refreshButton');
            if (refreshBtn) {
                const icon = refreshBtn.querySelector('i');
                icon.classList.add('rotating');
                setTimeout(() => {
                    icon.classList.remove('rotating');
                }, 1000);
            }
        }
        function resetCountdown(seconds) {
            const countdownEl = document.getElementById('refreshCountdown');
            if (!countdownEl) return;
            let remainingSeconds = seconds;
            if (window.countdownInterval) {
                clearInterval(window.countdownInterval);
            }
            function updateCountdown() {
                if (!document.getElementById('refreshCountdown')) {
                    clearInterval(window.countdownInterval);
                    return;
                }
                const minutes = Math.floor(remainingSeconds / 60);
                const secs = Math.floor(remainingSeconds % 60);
                document.getElementById('refreshCountdown').textContent =
                    `(${minutes}:${secs < 10 ? '0' : ''}${secs}åè‡ªåŠ¨åˆ·æ–°)`;
                remainingSeconds--;
                if (remainingSeconds < 0) {
                    clearInterval(window.countdownInterval);
                    setTimeout(() => refreshData(true), 100);
                }
            }
            updateCountdown();
            window.countdownInterval = setInterval(updateCountdown, 1000);
        }
        // å·²ç§»é™¤å•ä¸ªä»£å¸ä»·æ ¼è¯·æ±‚é€»è¾‘ï¼Œç»Ÿä¸€ä¾èµ– batch=all
        function loadAirdropData(forceFresh = false) {
            fetch(`/api/data?fresh=${forceFresh ? '1' : '0'}`)
                .then(response => response.json())
                .then(async data => {
                    if (!data || !data.airdrops || !Array.isArray(data.airdrops)) {
                        displayNoDataMessage();
                        return;
                    }
                    const processedData = processAirdropData(data.airdrops);
                    renderAirdrops(processedData);
                    updateLastUpdateTime();
                    
                    // åªè·å–å½“å¤©æ˜¾ç¤ºä¸”æœ‰æ•°é‡çš„ä»£å¸ä»·æ ¼
                    const displayedAirdrops = [...window.todayAirdrops || []];
                    if (displayedAirdrops.length === 0) {
                        return; // å¦‚æœæ²¡æœ‰å½“å¤©çš„ä»£å¸ï¼Œç›´æ¥è¿”å›
                    }
                    
                    // æ”¶é›†éœ€è¦å¤„ç†çš„ä»£å¸
                    const tokensToFetch = new Set();
                    const tokensNeedingDex = []; // éœ€è¦DEXä»·æ ¼çš„ä»£å¸æ•°ç»„ï¼ŒåŒ…å«åˆçº¦ä¿¡æ¯
                    
                    displayedAirdrops.forEach(airdrop => {
                        if (airdrop.token && airdrop.amount && !isNaN(parseFloat(airdrop.amount))) {
                            const token = airdrop.token;
                            tokensToFetch.add(token);
                            
                            // æ”¶é›†éœ€è¦DEXä»·æ ¼çš„ä»£å¸
                            if (airdrop.contract_address && airdrop.chain_id) {
                                if (!tokensNeedingDex.some(item => item.token === token)) {
                                    tokensNeedingDex.push({
                                        token: token,
                                        contract_address: airdrop.contract_address,
                                        chain_id: airdrop.chain_id
                                    });
                                }
                            }
                        }
                    });
                    
                    if (tokensToFetch.size > 0) {
                        // 1. å…ˆæ‰¹é‡è·å–æ‰€æœ‰ç¼“å­˜ä»·æ ¼
                        try {
                            // ä½¿ç”¨ä¼˜åŒ–çš„today APIï¼Œåªè·å–ä»Šæ—¥ç©ºæŠ•ç›¸å…³çš„tokenä»·æ ¼
                            const batchResponse = await fetch(`/api/price/?batch=today`);
                            const batchData = await batchResponse.json();
                            
                            if (batchData.success) {
                                // æ›´æ–°ç¼“å­˜å’ŒUI
                                for (const [token, priceData] of Object.entries(batchData.prices)) {
                                    updatePriceDisplay(token, priceData, displayedAirdrops);
                                }
                                // ä¸å†è§¦å‘å•å¸è¡¥é½ï¼Œæ¸²æŸ“ä»…ä¾èµ– batch=all è¿”å›å†…å®¹
                            }
                        } catch (error) { }
                    }
                })
                .catch(error => {
                    displayNoDataMessage();
                });
        }
        
        // æ›´æ–°ä»·æ ¼æ˜¾ç¤ºå‡½æ•° - äº¤æ˜“æ‰€ä»·æ ¼å’ŒDEXä»·æ ¼åˆ†è¡Œæ˜¾ç¤º
        function updatePriceDisplay(token, priceData, airdrops, priceElements, priceType = null) {
            // æ‰¾åˆ°åŒ¹é…çš„ç©ºæŠ•æ•°æ®
            const matchingAirdrops = airdrops.filter(airdrop => airdrop.token === token);
            
            if (matchingAirdrops.length === 0) {
                return;
            }
            
            matchingAirdrops.forEach(airdrop => {
                if (!airdrop.amount || isNaN(parseFloat(airdrop.amount))) return;
                
                const amount = parseFloat(airdrop.amount);
                
                // æ›´æ–°ä»·æ ¼æ•°æ®ï¼Œåªä¿ç•™1ä½å°æ•°
                if ((!priceType || priceType === 'exchange') && !airdrop.has_homonym) {
                    if (priceData.price && priceData.price > 0) {
                        airdrop.price = priceData.price;
                        airdrop.value = Math.round(priceData.price * amount * 10) / 10;
                    }
                }
                
                // å¤„ç†DEXä»·æ ¼ - å…¼å®¹ä¸¤ç§APIè¿”å›æ ¼å¼
                if (!priceType || priceType === 'dex') {
                    // 1. æ£€æŸ¥dex_priceå­—æ®µ
                    if (priceData.dex_price && priceData.dex_price > 0) {
                        airdrop.dex_price = priceData.dex_price;
                        airdrop.dex_value = Math.round(priceData.dex_price * amount * 10) / 10;
                    } 
                    // 2. å¦‚æœdex_priceä¸å­˜åœ¨ä½†sourceåŒ…å«"dex"ï¼Œåˆ™ä½¿ç”¨priceå­—æ®µä½œä¸ºDEXä»·æ ¼
                    else if (priceData.source && 
                             (priceData.source.includes('dex') || priceData.source.includes('DEX')) && 
                             priceData.price && priceData.price > 0) {
                        airdrop.dex_price = priceData.price;
                        airdrop.dex_value = Math.round(priceData.price * amount * 10) / 10;
                    }
                }
                
                // æ‰¾åˆ°è¿™ä¸ªä»£å¸å¯¹åº”çš„æ‰€æœ‰ä»·æ ¼å®¹å™¨å¹¶æ›´æ–°
                const containers = document.querySelectorAll(`.price-container[data-token="${token}"]`);
                
                containers.forEach(container => {
                    // æ¸…ç©ºç°æœ‰å®¹å™¨
                    container.innerHTML = '';
                    
                    // æ·»åŠ DEXä»·æ ¼ - æ”¾åœ¨ä¸Šé¢ï¼Œä½¿ç”¨é»„è‰²ï¼Œå¸¦é“¾æ¥
                    if (airdrop.dex_price && airdrop.dex_price > 0) {
                        const dexEl = document.createElement('div');
                        dexEl.className = 'value-text dex-price-value';
                        
                        // åˆ¤æ–­ç©ºæŠ•æ—¶é—´æ˜¯å¦è¿˜æ²¡åˆ°
                        const nowTimestamp = Math.floor(Date.now() / 1000);
                        let isUpcoming = false;
                        
                        if (airdrop.dateTime) {
                            let compareTimestamp = Math.floor(airdrop.dateTime.getTime() / 1000);
                            
                            // å¦‚æœæ˜¯ç¬¬äºŒé˜¶æ®µï¼Œå‡å»18å°æ—¶ï¼ˆ18 * 60 * 60 = 64800ç§’ï¼‰
                            if (airdrop.phase === 2) {
                                compareTimestamp = compareTimestamp - 64800;
                            }
                            
                            // TGEç‰¹æ®Šå¤„ç†
                            if (airdrop.type === 'tge') {
                                if (airdrop.pretge === true) {
                                    // Pre-TGEé¡¹ç›®ä¸€ç›´æ˜¾ç¤ºä¿¡æ¯å›¾æ ‡ï¼ˆå› ä¸ºé¢„å”®æ— ä»·æ ¼ï¼‰
                                    isUpcoming = true;
                                } else {
                                    // TGEé¡¹ç›®æŒ‰ç…§æ—¶é—´+2å°æ—¶åˆ¤æ–­è¿‡æœŸ
                                    const tgeEndTimestamp = compareTimestamp + (2 * 60 * 60); // åŠ 2å°æ—¶
                                    isUpcoming = nowTimestamp < tgeEndTimestamp;
                                }
                            } else {
                                isUpcoming = nowTimestamp < compareTimestamp;
                            }
                        }
                        
                        if (isUpcoming) {
                            const chainName = getChainName(airdrop.chain_id);
                            const rawContract = (airdrop.contract_address || '');
                            const isEvmAddress = rawContract && rawContract.startsWith('0x');
                            const contract = isEvmAddress ? rawContract.toLowerCase() : rawContract;
                            const useDebot = shouldUseDebot(airdrop.chain_id);
                            const linkUrl = (!useDebot || String(airdrop.chain_id).trim() === '784' || String(airdrop.chain_id).trim().toLowerCase() === 'sui')
                                ? `https://web3.okx.com/token/${chainName}/${rawContract}`
                                : `https://debot.ai/token/${chainName}/245734_${contract}`;
                            dexEl.innerHTML = `<i class="bi bi-info-circle price-info-icon" title="ç‚¹å‡»æŸ¥çœ‹è¯´æ˜" onclick="showPriceInfo()"></i> <a class="price-link" href="${linkUrl}" target="_blank" rel="noopener">$${airdrop.dex_value.toFixed(1)}</a><span style="display:inline-block; width:12px;"></span> `;
                        } else {
                            const chainName = getChainName(airdrop.chain_id);
                            const rawContract = (airdrop.contract_address || '');
                            const isEvmAddress = rawContract && rawContract.startsWith('0x');
                            const contract = isEvmAddress ? rawContract.toLowerCase() : rawContract;
                            const useDebot = shouldUseDebot(airdrop.chain_id);
                            const linkUrl = (!useDebot || String(airdrop.chain_id).trim() === '784' || String(airdrop.chain_id).trim().toLowerCase() === 'sui')
                                ? `https://web3.okx.com/token/${chainName}/${rawContract}`
                                : `https://debot.ai/token/${chainName}/245734_${contract}`;
                            dexEl.innerHTML = `<a class="price-link" href="${linkUrl}" target="_blank" rel="noopener" title="æŸ¥çœ‹DEXä»·æ ¼"><i class="bi bi-activity dex-price-icon"></i></a> <a class="price-link" href="${linkUrl}" target="_blank" rel="noopener">$${airdrop.dex_value.toFixed(1)}</a><span style="display:inline-block; width:12px;"></span> `;
                        }
                        
                        container.appendChild(dexEl);
                    }
                    
                    // æ·»åŠ äº¤æ˜“æ‰€ä»·æ ¼ï¼ˆå¯¹äºæœ‰åŒåå¸ç§ä¸æ˜¾ç¤ºäº¤æ˜“æ‰€ä»·æ ¼ï¼‰ - æ”¾åœ¨ä¸‹é¢ï¼Œä½¿ç”¨ç™½è‰²
                    if (airdrop.price && airdrop.price > 0 && !airdrop.has_homonym) {
                        const exchangeEl = document.createElement('div');
                        exchangeEl.className = 'value-text exchange-price-value';
                        exchangeEl.innerHTML = `$${airdrop.value.toFixed(1)}`;
                        container.appendChild(exchangeEl);
                    }
                });
            });
        }

        function processAirdropData(airdrops) {
            const processedAirdrops = JSON.parse(JSON.stringify(airdrops));
            const today = new Date();
            const todayYear = today.getFullYear();
            const todayMonth = today.getMonth() + 1;
            const todayDay = today.getDate();
            const todayFormatted = `${todayYear}-${todayMonth.toString().padStart(2, '0')}-${todayDay.toString().padStart(2, '0')}`;
            const todayStart = new Date(todayYear, todayMonth - 1, todayDay, 0, 0, 0).getTime() / 1000;
            const todayEnd = new Date(todayYear, todayMonth - 1, todayDay, 23, 59, 59).getTime() / 1000;
            const nowTimestamp = Math.floor(Date.now() / 1000);
            
            // å¤„ç†æ¯ä¸ªç©ºæŠ•æ•°æ®ï¼Œè½¬æ¢æ—¶åŒº
            processedAirdrops.forEach(airdrop => {
                if (airdrop.completed) {
                    // å·²å®Œæˆçš„ç©ºæŠ•ä¸éœ€è¦é¢å¤–å¤„ç†
                }
                
                // å¤„ç†æœ‰æ—¥æœŸå’Œæ—¶é—´çš„ç©ºæŠ•
                if (airdrop.date && airdrop.time) {
                    try {
                        // æ£€æŸ¥æ˜¯å¦æ˜¯äºŒæ®µç©ºæŠ•
                        const isPhase2 = airdrop.phase === 2;
                        
                        // ä½¿ç”¨æ—¶åŒºåŠ©æ‰‹å°†åŒ—äº¬æ—¶é—´è½¬æ¢ä¸ºæœ¬åœ°æ—¶é—´
                        const localTimeInfo = TimeZoneHelper.convertBeijingToLocal(
                            airdrop.date, 
                            airdrop.time,
                            isPhase2
                        );
                        
                        if (localTimeInfo.success) {
                            // å­˜å‚¨åŸå§‹åŒ—äº¬æ—¶é—´
                            airdrop.beijing_date = airdrop.date;
                            airdrop.beijing_time = airdrop.time;
                            
                            // è½¬æ¢ä¸ºç”¨æˆ·æœ¬åœ°æ—¶åŒº
                            airdrop.date = localTimeInfo.date;
                            airdrop.time = localTimeInfo.time;
                            airdrop.dateTime = localTimeInfo.dateTime;
                            
                            // æ£€æŸ¥ç©ºæŠ•æ˜¯å¦å·²è¿‡æœŸ
                            const endTimeObj = new Date(localTimeInfo.dateTime.getTime() + 24 * 60 * 60 * 1000);
                            const endTimestamp = Math.floor(endTimeObj.getTime() / 1000);
                            if (nowTimestamp > endTimestamp) {
                                airdrop.expired = true;
                                airdrop.completed = true;
                            }
                        }
                    } catch (e) {
                        console.error("å¤„ç†ç©ºæŠ•æ—¶é—´å‡ºé”™:", e);
                    }
                } 
                // å¤„ç†åªæœ‰æ—¥æœŸæ²¡æœ‰æ—¶é—´çš„ç©ºæŠ• - æ·»åŠ è¿™æ®µé€»è¾‘
                else if (airdrop.date && (!airdrop.time || airdrop.time.trim() === '')) {
                    try {
                        // ä½¿ç”¨æ—¶åŒºåŠ©æ‰‹å°†åŒ—äº¬æ—¥æœŸè½¬æ¢ä¸ºæœ¬åœ°æ—¥æœŸï¼ˆä½¿ç”¨ä¸‹åˆ2ç‚¹ä½œä¸ºé»˜è®¤æ—¶é—´ç‚¹ï¼‰
                        const localTimeInfo = TimeZoneHelper.convertBeijingToLocal(
                            airdrop.date,
                            "14:00", // é»˜è®¤ä½¿ç”¨ä¸‹åˆ2ç‚¹
                            false
                        );
                        
                        if (localTimeInfo.success) {
                            // å­˜å‚¨åŸå§‹åŒ—äº¬æ—¶é—´
                            airdrop.beijing_date = airdrop.date;
                            
                            // è½¬æ¢ä¸ºç”¨æˆ·æœ¬åœ°æ—¶åŒºçš„æ—¥æœŸ
                            airdrop.date = localTimeInfo.date;
                            // åˆ›å»ºdateTimeå¯¹è±¡ï¼Œè¿™æ˜¯å…³é”®ç‚¹
                            airdrop.dateTime = localTimeInfo.dateTime;
                            
                            // æ£€æŸ¥æ˜¯å¦è¿‡æœŸ
                            const endTimeObj = new Date(localTimeInfo.dateTime.getTime() + 24 * 60 * 60 * 1000);
                            const endTimestamp = Math.floor(endTimeObj.getTime() / 1000);
                            if (nowTimestamp > endTimestamp) {
                                airdrop.expired = true;
                                airdrop.completed = true;
                            }
                        }
                    } catch (e) {
                        console.error("å¤„ç†ç©ºæŠ•æ—¥æœŸå‡ºé”™:", e);
                    }
                }
            });
            
            return processedAirdrops;
        }
        
        function displayNoDataMessage() {
            const noDataMessage = `
                <tr>
                    <td colspan="4" style="text-align: center; padding: 30px;">
                        <div style="color: var(--muted); margin-bottom: 12px;">æš‚æ— æ•°æ®</div>
                    </td>
                </tr>
            `;
            document.querySelector('#today-airdrops tbody').innerHTML = noDataMessage;
            document.querySelector('#upcoming-airdrops tbody').innerHTML = noDataMessage;
        }
        
        function updateLastUpdateTime() {
            const now = new Date();
            const formattedTime = now.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            }).replace(/\//g, '-');
        }
        
        // ç¡®ä¿é¡µé¢å§‹ç»ˆä½¿ç”¨æš—é»‘æ¨¡å¼
        document.addEventListener('DOMContentLoaded', function() {
            const htmlEl = document.documentElement;
            htmlEl.classList.add('dark-mode');
        });
        
        function renderAirdrops(airdrops) {
            const systemNow = new Date();
            const today = new Date();
            
            // æ ¹æ®æœ¬åœ°æ—¶åŒºè·å–ä»Šå¤©çš„æ—¥æœŸ
            const todayYear = today.getFullYear();
            const todayMonth = today.getMonth() + 1;
            const todayDay = today.getDate();
            const todayFormatted = `${todayYear}-${todayMonth.toString().padStart(2, '0')}-${todayDay.toString().padStart(2, '0')}`;
            const todayStart = new Date(todayYear, todayMonth - 1, todayDay, 0, 0, 0).getTime() / 1000;
            const todayEnd = new Date(todayYear, todayMonth - 1, todayDay, 23, 59, 59).getTime() / 1000;
            const nowTimestamp = Math.floor(Date.now() / 1000);
            
            // æŒ‰æ—¥æœŸæ’åº
            airdrops.sort((a, b) => {
                const dateA = a.date || '9999-12-31';
                const dateB = b.date || '9999-12-31';
                if (!dateA) return 1;
                if (!dateB) return -1;
                return dateA.localeCompare(dateB);
            });
            
            // è¿‡æ»¤ä»Šæ—¥ç©ºæŠ• - ä½¿ç”¨æœ¬åœ°æ—¶åŒº
            const todayAirdrops = airdrops.filter(airdrop => {
                const status = airdrop.status?.toLowerCase();
                const isOngoing = status === 'ongoing' || status === 'active' || status === 'live';
                
                // ä½¿ç”¨dateTimeå¯¹è±¡æ£€æŸ¥æ˜¯å¦ä¸ºä»Šå¤©
                if (airdrop.dateTime) {
                    if (TimeZoneHelper.isToday(airdrop.dateTime)) {
                        return true;
                    }
                } 
                // å¯¹äºæ²¡æœ‰å…·ä½“æ—¶é—´çš„ç©ºæŠ•ï¼Œæ£€æŸ¥æ—¥æœŸæ˜¯å¦ä¸ºä»Šå¤©
                else if (airdrop.date) {
                    const isToday = airdrop.date === todayFormatted;
                    if (isToday) return true;
                }
                // å¤„ç†çŠ¶æ€ä¸º"ongoing"ä½†æ²¡æœ‰å…·ä½“æ—¥æœŸçš„ç©ºæŠ•
                else if (isOngoing) {
                    if (airdrop.system_timestamp) {
                        const isToday = airdrop.system_timestamp >= todayStart && airdrop.system_timestamp <= todayEnd;
                        return isToday;
                    }
                    return true;
                }
                
                return false;
            });
            
            // è¿‡æ»¤æœªæ¥ç©ºæŠ• - ä½¿ç”¨æœ¬åœ°æ—¶åŒº
            const upcomingAirdrops = airdrops.filter(airdrop => {
                // ä½¿ç”¨dateTimeå¯¹è±¡æ£€æŸ¥æ˜¯å¦æ˜¯æœªæ¥
                if (airdrop.dateTime) {
                    if (!TimeZoneHelper.isToday(airdrop.dateTime)) {
                        const futureDate = new Date();
                        futureDate.setHours(23, 59, 59, 999);
                        return airdrop.dateTime > futureDate;
                    }
                } 
                // å¯¹äºæ²¡æœ‰å…·ä½“æ—¶é—´çš„ç©ºæŠ•ï¼Œæ£€æŸ¥æ—¥æœŸæ˜¯å¦ä¸ºæœªæ¥
                else if (airdrop.date) {
                    const isFuture = airdrop.date > todayFormatted;
                    return isFuture;
                }
                
                return false;
            });
            
            // ä¿å­˜åˆ°å…¨å±€å˜é‡ï¼Œç”¨äºä»·æ ¼æ›´æ–°
            window.todayAirdrops = todayAirdrops;
            window.upcomingAirdrops = upcomingAirdrops;
            
            // æ¸²æŸ“è¡¨æ ¼
            renderAirdropTable(todayAirdrops, 'today-airdrops');
            renderAirdropTable(upcomingAirdrops, 'upcoming-airdrops');
        }
        
        function renderAirdropTable(airdrops, tableId) {
            const tableBody = document.querySelector(`#${tableId} tbody`);
            tableBody.innerHTML = '';
            if (airdrops.length === 0) {
                let promoContent = '<div style="color: var(--muted); margin-bottom: 12px;">æš‚æ— æ•°æ®</div>';
                
                if (globalPromoData && Array.isArray(globalPromoData)) {
                    const fallbackItem = globalPromoData.find(item => 
                        item.category === 'fallback' && 
                        item.fallback_type === tableId &&
                        item.status === 'active'
                    );
                    if (fallbackItem) {
                        // æ”¯æŒåœ¨ promo-data.json ä¸­ä½¿ç”¨å¯é€‰çš„ color å­—æ®µï¼Œè‡ªå®šä¹‰æŒ‰é’®ä¸»è‰²ï¼›é»˜è®¤ä½¿ç”¨é»„è‰²
                        const color = (fallbackItem.color && typeof fallbackItem.color === 'string' && fallbackItem.color.trim() !== '')
                            ? fallbackItem.color.trim()
                            : '#f0b90b';
                        const hoverBgColor = hexToRgba(color, 0.1);

                        promoContent = `
                            <div style="color: var(--muted); margin-bottom: 12px;">æš‚æ— æ•°æ®</div>
                            <div style="margin-top: 16px;">
                                <a href="${fallbackItem.url}" target="_blank" rel="noopener" 
                                   style="display: inline-flex; align-items: center; gap: 8px; color: ${color}; text-decoration: none; font-size: 14px; padding: 8px 12px; border: 1px solid ${color}; border-radius: 6px; transition: all 0.2s ease;"
                                   onmouseover="this.style.backgroundColor='${hoverBgColor}'" 
                                   onmouseout="this.style.backgroundColor='transparent'">
                                    <i class="bi ${fallbackItem.icon}"></i>
                                    <span>${fallbackItem.name}</span>
                                </a>
                            </div>
                        `;
                    }
                }
                
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align: center; padding: 30px;">
                            ${promoContent}
                        </td>
                    </tr>
                `;
                return;
            }
            airdrops.forEach((airdrop, index) => {
                const row = document.createElement('tr');
                const tokenCell = document.createElement('td');
                const tokenSymbol = airdrop.token || 'UNKNOWN';
                let projectName = airdrop.name || 'æœªçŸ¥é¡¹ç›®';
                if (airdrop.type === 'warning') {
                    projectName = `<span style="color: var(--alert-color);">é¢„æµ‹</span>`;
                }
                
                // ä¸ºtokenæ·»åŠ  Debot/OKX é“¾æ¥
                let tokenSymbolHtml = tokenSymbol;
                if (airdrop.chain_id && airdrop.contract_address) {
                    const chainName = getChainName(airdrop.chain_id);
                    const rawContract = (airdrop.contract_address || '');
                    const isEvmAddress = rawContract && rawContract.startsWith('0x');
                    const contract = isEvmAddress ? rawContract.toLowerCase() : rawContract;
                    const useDebot = shouldUseDebot(airdrop.chain_id);
                    const linkUrl = (!useDebot || String(airdrop.chain_id).trim() === '784' || String(airdrop.chain_id).trim().toLowerCase() === 'sui')
                        ? `https://web3.okx.com/token/${chainName}/${rawContract}`
                        : `https://debot.ai/token/${chainName}/245734_${contract}`;
                    
                    // æ ¹æ®æ˜¯å¦ç°è´§/åˆçº¦ä¸Šå¸‚è®¾ç½®å›¾æ ‡é¢œè‰²å’Œæç¤ºï¼ˆç°è´§ä¼˜å…ˆï¼Œä¸”åªæ˜¾ç¤ºä¸€ä¸ªï¼‰
                    const isFuturesListed = airdrop.futures_listed === true;
                    const isSpotListed = airdrop.spot_listed === true;
                    let iconHtml = '';
                    if (isSpotListed) {
                        iconHtml = '<i class="bi bi-file-earmark-text contract-icon" style="color:#f0b90b; display:inline; margin-left:4px;" title="å¸å®‰ç°è´§"></i>';
                    } else if (isFuturesListed) {
                        iconHtml = '<i class="bi bi-file-earmark-text contract-icon" style="color:#22c55e; margin-left:4px;" title="å¸å®‰åˆçº¦"></i>';
                    } else {
                        iconHtml = '<i class="bi bi-file-earmark-text contract-icon" style="margin-left:4px;"></i>';
                    }
                    tokenSymbolHtml = `<a class="token-link" href="${linkUrl}" target="_blank" rel="noopener">${tokenSymbol}${iconHtml}</a>`;
                }
                
                tokenCell.innerHTML = `
                    <div class="token-name">
                        <div>
                            <div class="token-symbol">
                                ${tokenSymbolHtml}
                            </div>
                            <div class="token-fullname">${projectName}</div>
                        </div>
                    </div>
                `;
                row.appendChild(tokenCell);
                const pointsCell = document.createElement('td');
                pointsCell.innerHTML = `<span class="points-badge">${airdrop.points || '-'}</span>`;
                row.appendChild(pointsCell);
                const amountCell = document.createElement('td');
                if (airdrop.amount) {
                    const amount = parseFloat(airdrop.amount);
                    let html = '';
                    
                    // ä¸ºTGEé¡¹ç›®åœ¨æ•°é‡å‰æ·»åŠ é»„è‰²ä¿¡æ¯å›¾æ ‡
                    if (airdrop.type === 'tge' && airdrop.target_bnb && airdrop.actual_bnb) {
                        const targetBnb = parseFloat(airdrop.target_bnb);
                        const actualBnb = parseFloat(airdrop.actual_bnb);
                        const oversubscription = (actualBnb / targetBnb).toFixed(2);
                        const airdropDataStr = JSON.stringify(airdrop).replace(/"/g, '&quot;');
                        
                        html += `<i class="bi bi-bar-chart-fill tge-info-icon" 
                                   onclick="showTgeInfo('${airdrop.token}', ${targetBnb}, ${actualBnb}, ${oversubscription}, JSON.parse('${airdropDataStr}'))" 
                                   title="ç‚¹å‡»æŸ¥çœ‹TGEç»Ÿè®¡ä¿¡æ¯" 
                                   style="color: #F0B90B; cursor: pointer; font-size: 14px; -webkit-tap-highlight-color: transparent; touch-action: manipulation;"></i> `;
                    }
                    
                    html += `<span class="points-badge points-badge--compact">${amount}</span>`;
                    html += `<br><div class="price-container" data-token="${airdrop.token}"></div>`;
                    amountCell.innerHTML = html;
                } else {
                    amountCell.innerHTML = `<span class="points-badge">-</span>`;
                }
                row.appendChild(amountCell);
                const timeCell = document.createElement('td');
                let timeText = 'å¾…å…¬å¸ƒ';
                
                // ä½¿ç”¨dateTimeå¯¹è±¡æ˜¾ç¤ºæœ¬åœ°åŒ–çš„æ—¶é—´
                if (airdrop.dateTime) {
                    // æ£€æŸ¥æ˜¯å¦çœŸçš„æœ‰å…·ä½“æ—¶é—´ï¼ˆè€Œä¸åªæ˜¯æˆ‘ä»¬ä¸ºäº†è®¡ç®—æ·»åŠ çš„é»˜è®¤æ—¶é—´ï¼‰
                    if (airdrop.beijing_time && airdrop.beijing_time.trim() !== '') {
                        if (tableId === 'today-airdrops') {
                            // ä»Šæ—¥ç©ºæŠ•åªæ˜¾ç¤ºæ—¶é—´
                            timeText = TimeZoneHelper.formatTime(airdrop.dateTime);
                        } else {
                            // ç©ºæŠ•é¢„å‘Šæ˜¾ç¤ºæ—¥æœŸå’Œæ—¶é—´
                            if (TimeZoneHelper.isTomorrow(airdrop.dateTime)) {
                                timeText = `æ˜å¤© ${TimeZoneHelper.formatTime(airdrop.dateTime)}`;
                            } else if (TimeZoneHelper.isDayAfterTomorrow(airdrop.dateTime)) {
                                timeText = `åå¤© ${TimeZoneHelper.formatTime(airdrop.dateTime)}`;
                            } else {
                                const month = airdrop.dateTime.getMonth() + 1;
                                const day = airdrop.dateTime.getDate();
                                timeText = `${month}æœˆ${day}æ—¥ ${TimeZoneHelper.formatTime(airdrop.dateTime)}`;
                            }
                        }
                    
                        // å¦‚æœæ˜¯äºŒæ®µç©ºæŠ•ï¼Œæ·»åŠ æ ‡è®°
                        if (airdrop.phase === 2) {
                            timeText += "<br />(äºŒæ®µ)";
                        }
                    } else {
                        // æœ‰dateTimeä½†æ²¡æœ‰å…·ä½“æ—¶é—´ï¼Œè¯´æ˜è¿™æ˜¯åªæœ‰æ—¥æœŸæ²¡æœ‰æ—¶é—´çš„ç©ºæŠ•
                        if (tableId === 'today-airdrops') {
                            // ä»Šæ—¥ç©ºæŠ•ä¸­çš„æ— æ—¶é—´é¡¹ç›®æ˜¾ç¤º"å¾…å…¬å¸ƒ"
                            timeText = 'å¾…å…¬å¸ƒ';
                        } else {
                            // ç©ºæŠ•é¢„å‘Šä¸­æ˜¾ç¤ºæ—¥æœŸ
                            if (TimeZoneHelper.isTomorrow(airdrop.dateTime)) {
                                timeText = 'æ˜å¤©';
                            } else if (TimeZoneHelper.isDayAfterTomorrow(airdrop.dateTime)) {
                                timeText = 'åå¤©';
                            } else {
                                const month = airdrop.dateTime.getMonth() + 1;
                                const day = airdrop.dateTime.getDate();
                                timeText = `${month}æœˆ${day}æ—¥`;
                            }
                        }
                    }
                } else if (airdrop.time && airdrop.time.trim() !== '') {
                    // å¤‡ç”¨ï¼šå¦‚æœæ²¡æœ‰dateTimeå¯¹è±¡ä½†æœ‰æ—¶é—´
                    timeText = airdrop.time;
                } else if (airdrop.date && airdrop.date.trim() !== '') {
                    // å¤„ç†åªæœ‰æ—¥æœŸæ²¡æœ‰æ—¶é—´çš„æƒ…å†µ
                    try {
                        // å¦‚æœæ˜¯ä»Šæ—¥ç©ºæŠ•ï¼Œæ— æ—¶é—´åˆ™æ˜¾ç¤º"å¾…å…¬å¸ƒ"
                        if (tableId === 'today-airdrops') {
                            timeText = 'å¾…å…¬å¸ƒ';
                        } 
                        // åªæœ‰é¢„å‘Šæ‰æ˜¾ç¤ºæ—¥æœŸ
                        else {
                            // åˆ›å»ºåŒ—äº¬æ—¶é—´çš„æ—¥æœŸå¯¹è±¡ï¼ˆå°†æ—¥æœŸè§†ä¸ºUTC+8ï¼‰
                            const beijingDateParts = airdrop.date.split('-');
                            if (beijingDateParts.length === 3) {
                                // ä½¿ç”¨ç›¸åŒçš„è½¬æ¢é€»è¾‘å¤„ç†åªæœ‰æ—¥æœŸçš„æƒ…å†µ
                                const localTimeInfo = TimeZoneHelper.convertBeijingToLocal(
                                    airdrop.date, 
                                    "14:00", // é»˜è®¤ä½¿ç”¨ä¸‹åˆ2ç‚¹ï¼Œå‡å°‘æ—¶åŒºå½±å“
                                    false
                                );
                                
                                if (localTimeInfo.success) {
                                    const dateObj = localTimeInfo.dateTime;
                                    if (!isNaN(dateObj.getTime())) {
                                        if (TimeZoneHelper.isTomorrow(dateObj)) {
                                            timeText = 'æ˜å¤©';
                                        } else if (TimeZoneHelper.isDayAfterTomorrow(dateObj)) {
                                            timeText = 'åå¤©';
                                        } else {
                                            const month = dateObj.getMonth() + 1;
                                            const day = dateObj.getDate();
                                            timeText = `${month}æœˆ${day}æ—¥`;
                                        }
                                    }
                                } else {
                                    // å¦‚æœè½¬æ¢å¤±è´¥ï¼Œä½¿ç”¨åŸæ¥çš„æ–¹å¼ï¼ˆä½œä¸ºå¤‡ç”¨ï¼‰
                                    const dateObj = new Date(airdrop.date);
                                    if (!isNaN(dateObj.getTime())) {
                                        if (TimeZoneHelper.isTomorrow(dateObj)) {
                                            timeText = 'æ˜å¤©';
                                        } else if (TimeZoneHelper.isDayAfterTomorrow(dateObj)) {
                                            timeText = 'åå¤©';
                                        } else {
                                            const month = dateObj.getMonth() + 1;
                                            const day = dateObj.getDate();
                                            timeText = `${month}æœˆ${day}æ—¥`;
                                        }
                                    }
                                }
                            }
                        }
                    } catch (e) {
                        console.error("æ ¼å¼åŒ–æ—¥æœŸå‡ºé”™:", e);
                    }
                }
                
                let typeHtml = '';
                let hasStatusIcon = false; // æ ‡è®°æ˜¯å¦å·²æœ‰çŠ¶æ€å›¾æ ‡
                
                if (airdrop.dateTime || (airdrop.time && airdrop.time.trim() !== '')) {
                    if (airdrop.expired || airdrop.completed) {
                        typeHtml = `<i class="bi bi-check-circle-fill completed-icon" title="å·²é¢†å–å®Œæ¯•"></i>`;
                        hasStatusIcon = true;
                    } else if (airdrop.type === 'grab') {
                        typeHtml = `<i class="bi bi-lightning-fill" style="color: var(--grab-color); margin-left: 6px;" title="å…ˆåˆ°å…ˆå¾—"></i>`;
                        hasStatusIcon = true;
                    }
                }
                
                // ä¸º TGE ç±»å‹æ·»åŠ ç‰¹æ®Šæ ‡è®°
                let timeDisplay = timeText;
                if (airdrop.type === 'tge') {
                    if (airdrop.pretge === true) {
                        timeDisplay += '<br />(Pre-TGE)';
                    } else if (airdrop.bctge === true) {
                        timeDisplay += '<br />(BC-TGE)';
                    } else {
                        timeDisplay += '<br />(TGE)';
                    }
                }
                
                // æ·»åŠ é¢„è­¦è¯´æ˜å°å­—
                let warningNote = '';
                if (airdrop.type === 'warning') {
                    warningNote = `<div style="font-size:0.75em;color:#999;margin-top:3px;line-height:1.2;font-style:italic;">
                        <i class="bi bi-info-circle-fill" style="color:var(--alert-color);font-size:0.9em;"></i> 
                        åŸºäºé“¾ä¸Šæ•°æ®é¢„æµ‹ï¼Œå¯èƒ½è¯¯æŠ¥
                    </div>`;
                }
                
                // ä¸ºç©ºæŠ•é¢„å‘Šæ·»åŠ å›¾æ ‡ï¼šç¬¬äºŒæ®µæ˜¾ç¤ºé—ªç”µï¼Œéç¬¬äºŒæ®µæ˜¾ç¤ºè®¢é˜…é“ƒé“›
                if (tableId === 'upcoming-airdrops') {
                    if (airdrop.phase === 2) {
                        // ç¬¬äºŒæ®µç©ºæŠ•æ˜¾ç¤ºé—ªç”µå›¾æ ‡
                        typeHtml = `<i class="bi bi-lightning-fill" style="color: var(--grab-color); margin-left: 6px;" title="ç¬¬äºŒæ®µç©ºæŠ•"></i>`;
                    } else {
                        // éç¬¬äºŒæ®µæ˜¾ç¤ºè®¢é˜…é“ƒé“›
                        typeHtml = `<button class="reminder-bell" onclick="openTwitterModal()" title="ç‚¹å‡»å…³æ³¨æ¨ç‰¹è·å–æå‰20åˆ†é’Ÿé€šçŸ¥">
                            <svg viewBox="0 0 24 24" aria-hidden="true" class="bell-svg">
                                <g><path d="M22 5v2h-3v3h-2V7h-3V5h3V2h2v3h3zm-.86 13h-4.241c-.464 2.281-2.482 4-4.899 4s-4.435-1.719-4.899-4H2.87L4 9.05C4.51 5.02 7.93 2 12 2v2C8.94 4 6.36 6.27 5.98 9.3L5.13 16h13.73l-.38-3h2.02l.64 5zm-6.323 0H9.183c.412 1.164 1.51 2 2.817 2s2.405-.836 2.817-2z"></path></g>
                            </svg>
                        </button>`;
                    }
                }
                
                timeCell.innerHTML = `<div class="time-cell">${timeDisplay} ${typeHtml}</div>${warningNote}`;
                row.appendChild(timeCell);
                tableBody.appendChild(row);
            });
        }
        
        function formatDateTime(timestamp) {
            if (!timestamp) return 'æœªçŸ¥æ—¶é—´';
            const date = new Date(timestamp * 1000);
            return date.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            }).replace(/\//g, '-');
        }
        
        // æ¨ç‰¹æé†’æ¨¡æ€æ¡†ç›¸å…³å‡½æ•°
        function openTwitterModal() {
            document.getElementById('twitterReminderModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
        
        function closeTwitterModal() {
            document.getElementById('twitterReminderModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        // å¤„ç†æ¨ç‰¹é“¾æ¥è·³è½¬ï¼ˆç§»åŠ¨ç«¯ä¼˜å…ˆè·³è½¬åˆ°appï¼‰
        function handleTwitterLink(event) {
            event.preventDefault();
            
            // æ£€æµ‹æ˜¯å¦æ˜¯ç§»åŠ¨è®¾å¤‡
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobile) {
                // å°è¯•æ‰“å¼€æ¨ç‰¹app
                window.location.href = 'twitter://user?screen_name=alpha123cc';
                
                // å¦‚æœappæ²¡æœ‰å®‰è£…ï¼Œ2ç§’åè·³è½¬åˆ°ç½‘é¡µç‰ˆ
                setTimeout(function() {
                    window.open('https://twitter.com/alpha123cc', '_blank');
                }, 2000);
            } else {
                // æ¡Œé¢ç«¯ç›´æ¥æ‰“å¼€ç½‘é¡µç‰ˆ
                window.open('https://twitter.com/alpha123cc', '_blank');
            }
        }
        
        // æ·»åŠ ä¿¡æ¯å›¾æ ‡æ ·å¼å’Œæ¨èå·¥å…·æ ·å¼
        const style = document.createElement('style');
        style.textContent = `
            .price-info-icon {
                color: #F0B90B !important;
                cursor: pointer;
                transition: color 0.2s ease;
                -webkit-tap-highlight-color: transparent;
                touch-action: manipulation;
            }
            .price-info-icon:hover {
                color: #D19F0B !important;
            }
            
        `;
        document.head.appendChild(style);

        // æ˜¾ç¤ºä»·æ ¼ä¿¡æ¯æç¤º
        function showPriceInfo() {
            const message = 'ç›˜å‰ä¸´è¿‘æ‰æœ‰å‚è€ƒä»·å€¼ï¼Œæ¥æº1inchæˆ–pancake';
            
            // åˆ›å»ºç®€æ´çš„æç¤ºæ¡†
            const tooltip = document.createElement('div');
            tooltip.className = 'price-info-tooltip';
            tooltip.textContent = message;
            tooltip.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 0, 0.9);
                color: white;
                padding: 12px 16px;
                border-radius: 6px;
                font-size: 14px;
                z-index: 10000;
                max-width: 280px;
                text-align: center;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                pointer-events: none;
                opacity: 0;
                transition: opacity 0.3s ease;
            `;
            
            document.body.appendChild(tooltip);
            
            // æ·¡å…¥æ•ˆæœ
            setTimeout(() => {
                tooltip.style.opacity = '1';
            }, 10);
            
            // 2ç§’åè‡ªåŠ¨æ¶ˆå¤±
            setTimeout(() => {
                tooltip.style.opacity = '0';
                setTimeout(() => {
                    if (tooltip.parentNode) {
                        document.body.removeChild(tooltip);
                    }
                }, 300);
            }, 2000);
        }

        // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
        document.addEventListener('DOMContentLoaded', function() {
            const modal = document.getElementById('twitterReminderModal');
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        closeTwitterModal();
                    }
                });
            }
        });
    </script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "s8evkid0ub");
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'983b8a474c93f7db',t:'MTc1ODY0NjIxNg=='};var a=document.createElement('script');a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"05b2f73255d64509b38e379d9142b573","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
</html>
